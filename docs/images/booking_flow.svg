<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="740" viewBox="0 0 1100 740">
  <defs>
    <style><![CDATA[
      .title { font: 700 22px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, sans-serif; fill: #111827; }
      .label { font: 600 14px/1.3 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, sans-serif; fill: #1f2937; }
      .small { font: 500 12px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, sans-serif; fill: #374151; }
      .lane { fill: #ffffff; stroke: #c7d2fe; stroke-width: 2; rx: 10; }
      .bg { fill: #f8fafc; }
      .arrow { stroke: #0ea5e9; stroke-width: 2; marker-end: url(#arrowhead); }
      .box { fill: #ecfeff; stroke: #67e8f9; rx: 6; }
      .note { fill: #eef2ff; stroke: #c7d2fe; rx: 6; }
    ]]></style>
    <marker id="arrowhead" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <polygon points="0 0, 6 3, 0 6" fill="#0ea5e9" />
    </marker>
  </defs>
  <rect class="bg" x="0" y="0" width="1100" height="740"/>
  <text class="title" x="30" y="40">Booking Flow – Student books a session</text>

  <!-- Lanes -->
  <rect class="lane" x="30" y="70" width="320" height="620"/>
  <text class="label" x="50" y="95">Frontend (Browser)</text>

  <rect class="lane" x="390" y="70" width="320" height="620"/>
  <text class="label" x="410" y="95">API (Express)</text>

  <rect class="lane" x="750" y="70" width="320" height="620"/>
  <text class="label" x="770" y="95">Database (MongoDB)</text>

  <!-- Steps -->
  <rect class="box" x="50" y="130" width="280" height="60"/>
  <text class="small" x="60" y="155">1) Student logs in (identifier + password)</text>
  <line class="arrow" x1="330" y1="160" x2="390" y2="160"/>
  <rect class="note" x="410" y="130" width="280" height="60"/>
  <text class="small" x="420" y="155">Verify credentials → issue JWT</text>
  <line class="arrow" x1="690" y1="160" x2="750" y2="160"/>
  <rect class="note" x="770" y="130" width="280" height="60"/>
  <text class="small" x="780" y="155">User lookup in users collection</text>

  <rect class="box" x="50" y="220" width="280" height="60"/>
  <text class="small" x="60" y="245">2) Browse available sessions</text>
  <line class="arrow" x1="330" y1="250" x2="390" y2="250"/>
  <rect class="note" x="410" y="220" width="280" height="60"/>
  <text class="small" x="420" y="245">GET /api/sessions/available</text>
  <line class="arrow" x1="690" y1="250" x2="750" y2="250"/>
  <rect class="note" x="770" y="220" width="280" height="60"/>
  <text class="small" x="780" y="245">Query sessions where status=available</text>

  <rect class="box" x="50" y="310" width="280" height="60"/>
  <text class="small" x="60" y="335">3) Click "Book" on a slot</text>
  <line class="arrow" x1="330" y1="340" x2="390" y2="340"/>
  <rect class="note" x="410" y="310" width="280" height="60"/>
  <text class="small" x="420" y="335">PUT /api/sessions/:id/book (Bearer)</text>
  <line class="arrow" x1="690" y1="340" x2="750" y2="340"/>
  <rect class="note" x="770" y="310" width="280" height="60"/>
  <text class="small" x="780" y="335">Set student, status → booked</text>

  <rect class="box" x="50" y="400" width="280" height="60"/>
  <text class="small" x="60" y="425">4) UI updates, success toast/snackbar</text>
  <line class="arrow" x1="330" y1="430" x2="390" y2="430"/>
  <rect class="note" x="410" y="400" width="280" height="60"/>
  <text class="small" x="420" y="425">Response includes populated tutor/student</text>

  <rect class="box" x="50" y="520" width="280" height="80"/>
  <text class="small" x="60" y="545">Edge cases:</text>
  <text class="small" x="60" y="565">• Already booked → 400</text>
  <text class="small" x="60" y="585">• Missing/invalid token → 401</text>

  <rect class="box" x="410" y="520" width="280" height="80"/>
  <text class="small" x="420" y="545">Validation:</text>
  <text class="small" x="420" y="565">• Role must be student</text>
  <text class="small" x="420" y="585">• Ownership checks on cancel</text>

  <rect class="box" x="770" y="520" width="280" height="80"/>
  <text class="small" x="780" y="545">Indexes:</text>
  <text class="small" x="780" y="565">• status/date</text>
  <text class="small" x="780" y="585">• tutor/date, student/date</text>
</svg>
