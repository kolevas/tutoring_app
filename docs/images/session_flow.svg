<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="760" viewBox="0 0 1100 760">
  <defs>
    <style><![CDATA[
      .title { font: 700 22px/1.2 system-ui; fill: #111827; }
      .label { font: 600 14px/1.3 system-ui; fill: #1f2937; }
      .small { font: 500 12px/1.4 system-ui; fill: #374151; }
      .lane { fill: #ffffff; stroke: #fed7aa; stroke-width: 2; rx: 10; }
      .bg { fill: #fff7ed; }
      .arrow { stroke: #f97316; stroke-width: 2; marker-end: url(#arrowhead); }
      .box { fill: #ffedd5; stroke: #fdba74; rx: 6; }
      .note { fill: #fde68a; stroke: #facc15; rx: 6; }
    ]]></style>
    <marker id="arrowhead" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
      <polygon points="0 0, 6 3, 0 6" fill="#f97316" />
    </marker>
  </defs>
  <rect class="bg" x="0" y="0" width="1100" height="760"/>
  <text class="title" x="30" y="40">Session Management Flow – Create / Update / Cancel</text>

  <rect class="lane" x="30" y="70" width="320" height="660"/>
  <text class="label" x="50" y="95">Frontend (Tutor/Student)</text>

  <rect class="lane" x="390" y="70" width="320" height="660"/>
  <text class="label" x="410" y="95">API (Express)</text>

  <rect class="lane" x="750" y="70" width="320" height="660"/>
  <text class="label" x="770" y="95">Database (MongoDB)</text>

  <!-- Create -->
  <rect class="box" x="50" y="130" width="280" height="60"/>
  <text class="small" x="60" y="155">1) Tutor POST /api/sessions</text>
  <line class="arrow" x1="330" y1="160" x2="390" y2="160"/>
  <rect class="note" x="410" y="130" width="280" height="60"/>
  <text class="small" x="420" y="155">Check availability + conflicts</text>
  <line class="arrow" x1="690" y1="160" x2="750" y2="160"/>
  <rect class="note" x="770" y="130" width="280" height="60"/>
  <text class="small" x="780" y="155">Insert session with status=available</text>

  <!-- Update -->
  <rect class="box" x="50" y="220" width="280" height="60"/>
  <text class="small" x="60" y="245">2) PUT /api/sessions/:id</text>
  <line class="arrow" x1="330" y1="250" x2="390" y2="250"/>
  <rect class="note" x="410" y="220" width="280" height="60"/>
  <text class="small" x="420" y="245">Owner or admin; run validators</text>

  <!-- Book -->
  <rect class="box" x="50" y="310" width="280" height="60"/>
  <text class="small" x="60" y="335">3) Student PUT /api/sessions/:id/book</text>
  <line class="arrow" x1="330" y1="340" x2="390" y2="340"/>
  <rect class="note" x="410" y="310" width="280" height="60"/>
  <text class="small" x="420" y="335">status must be available → booked</text>
  <line class="arrow" x1="690" y1="340" x2="750" y2="340"/>
  <rect class="note" x="770" y="310" width="280" height="60"/>
  <text class="small" x="780" y="335">Update student ref + status</text>

  <!-- Cancel -->
  <rect class="box" x="50" y="400" width="280" height="60"/>
  <text class="small" x="60" y="425">4) PUT /api/sessions/:id/cancel</text>
  <line class="arrow" x1="330" y1="430" x2="390" y2="430"/>
  <rect class="note" x="410" y="400" width="280" height="60"/>
  <text class="small" x="420" y="425">Student or tutor or admin</text>
  <line class="arrow" x1="690" y1="430" x2="750" y2="430"/>
  <rect class="note" x="770" y="400" width="280" height="60"/>
  <text class="small" x="780" y="425">Unset student; status → available</text>

  <!-- Lists -->
  <rect class="box" x="50" y="500" width="280" height="60"/>
  <text class="small" x="60" y="525">5) GET /api/sessions (filters)</text>
  <line class="arrow" x1="330" y1="530" x2="390" y2="530"/>
  <rect class="note" x="410" y="500" width="280" height="60"/>
  <text class="small" x="420" y="525">status, tutor, student, date</text>

  <!-- Notes -->
  <rect class="box" x="410" y="590" width="280" height="80"/>
  <text class="small" x="420" y="615">Prevent update when booked unless cancel</text>
  <text class="small" x="420" y="635">Populate tutor/student on fetch</text>
</svg>
